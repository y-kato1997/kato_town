<!doctype html>
<html>

<head>
  <meta charset="UTF-8">
  <title>kato.town</title>
  <meta name="description" content="加藤のためのサイト">
  <meta property="og:title" content="kato.click">
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://kato.click">
  <meta property="og:site_name" content="kato.click">
  <meta property="og:description" content="加藤のためのサイト">
  <meta property="og:image" content="https://kato.click/img/kato_thumbnail.png">
  <meta property="fb:app_id" content="3027674887272797">
  <link rel="apple-touch-icon" type="image/png" href="./img/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="./img/icon-192x192.png">
  <style>
    * {
      margin: 0px;
      padding: 0px;
    }
  </style>
</head>

<body>
  <script src="./js/p5.js"></script>
  <script src="./js/p5.dom.js"></script>
  <script src="./js/p5.sound.js"></script>
  <script>
    let myFont;
    var countKato = 0;
    var katoItems = [];
    var maxTextSize = 0;
    var soundMute = true;

    function preload() {
      myFont = loadFont('./asset/NotoSerifJP-Medium.otf');
    }

    function setup() {
      createCanvas(windowWidth, windowHeight, WEBGL);
      angleMode(DEGREES);
      setTextSize();

      //生成される文字の数(5~10個)
      var maxTextQty = Math.floor(Math.random() * 5) + 5;

      for (var i = 0; i < maxTextQty; i++) {
        katoItems.push(katoGenerator());
        countKato++;
      }
    }

    function draw() {
      background(17, 17, 17);
      textFont(myFont);

      for (let i = 0; i < katoItems.length; i++) {
        katoItems[i]['textSize'] += 0.5;
        katoItems[i]['textRotate'] += 0.02;
        katoItems[i]['textOpacity'] -= 1.5;

        textAlign(CENTER);
        rectMode(CENTER);

        push();

        fill(
          katoItems[i]['textColorR'],
          katoItems[i]['textColorG'],
          katoItems[i]['textColorB'],
          katoItems[i]['textOpacity']
        );

        translate(
          katoItems[i]['textPositionX'],
          katoItems[i]['textPositionY'],
          katoItems[i]['textPositionZ']
        );

        textSize(
          katoItems[i]['textSize']
        );

        rotateZ(
          katoItems[i]['textRotate']
        );

        text('加\n藤', 0, 0);

        pop();

        if (katoItems[i]['textOpacity'] < 0) {
          let katoParam = katoGenerator();
          katoItems[i]['textPositionX'] = katoParam['textPositionX'];
          katoItems[i]['textPositionY'] = katoParam['textPositionY'];
          katoItems[i]['textPositionZ'] = 0;
          katoItems[i]['textSize'] = katoParam['textSize'];
          katoItems[i]['textOpacity'] = katoParam['textOpacity'];
          katoItems[i]['textRotate'] = katoParam['textRotate'];
        }
      }
    }

    function windowResized() {
      resizeCanvas(windowWidth, windowHeight);
      setTextSize();
    }

    function setTextSize() {
      let textSizeParam = 6;
      if (height > width) {
        maxTextSize = height / textSizeParam;
      } else {
        maxTextSize = width / textSizeParam;
      }
    }

    function katoGenerator() {
      return {
        'textPositionX': round(random(-width / 2, width / 2)),
        'textPositionY': round(random(-height / 2, height / 2)),
        'textPositionZ': 0,
        'textSize': round(random(1, maxTextSize)),
        'textColorR': 255,
        'textColorG': 255,
        'textColorB': 255,
        'textOpacity': round(random(50, 255)),
        'textRotate': round(random(-140, 140)),
        'isTouch': false
      }
    }
  </script>
</body>

</html>
